<div th:fragment="result2-2" class="p-8">
    <div class="container mx-auto px-4 py-8">
        <h1 class="text-2xl font-bold mb-4">보안 점검 결과 차트</h1>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="bg-gray-100 p-4 rounded-lg shadow">
<!--                <h2 class="text-lg font-semibold mb-2">중요도 및 상태 차트</h2>-->
                <canvas id="importanceStatusChart"></canvas>
                <span>높음 중요도에서 우수** 개</span>
                <span>높음 중요도에서 양호** 개</span>
                <span>높음 중요도에서 취약** 개</span>
            </div>
            <div>
                <canvas class="grid-cols-2 bg-white p-1 rounded-lg shadow" id="categorySecurityChart"></canvas>
            </div>
        </div>
    </div>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script th:inline="javascript">
 document.addEventListener('DOMContentLoaded', function () {
        const importanceStatusData = /*[[${importanceStatusData}]]*/ {};
        const importanceStatusCtx = document.getElementById('importanceStatusChart').getContext('2d');
     const importanceLevels = Object.keys(importanceStatusData);
        const statusTypes = ['[양호]', '[취약]', '[N/A]'];

        new Chart(importanceStatusCtx, {
            type: 'bar',
            data: {
                labels: importanceLevels,
                datasets: statusTypes.map(status => ({
                    label: status,
                    data: importanceLevels.map(importance => importanceStatusData[importance][status] || 0),
                    backgroundColor: status === '[양호]' ? '#4BC0C0' : status === '[취약]' ? '#FF6384' : '#FFCE56'
                }))
            },
            options: {
                responsive: true,
                scales: {
                    x: { stacked: true },
                    y: { stacked: true, beginAtZero: true }
                }
            }
        });

        // 카테고리별 보안 점수 차트
        const categorySecurityData = /*[[${categorySecurity}]]*/ {};
        const categorySecurityCtx = document.getElementById('categorySecurityChart').getContext('2d');

        new Chart(categorySecurityCtx, {
            type: 'pie',
            data: {
                labels: Object.keys(categorySecurityData),
                datasets: [{
                    data: Object.values(categorySecurityData),
                    backgroundColor: Object.keys(categorySecurityData).map((_, index) =>
                        `hsl(${index * 360 / Object.keys(categorySecurityData).length}, 70%, 60%)`)
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: { position: 'right' },
                    tooltip: {
                        callbacks: {
                            label: function (context) {
                                return `${context.label}: ${context.formattedValue}%`;
                            }
                        }
                    }
                }
            }
        });
    });
    /*]]>*/
    </script>
</div>
